x- Be robust to invalid snippet files

- Fix bug where snippet ends on the same line as a variable
- Replace "typescript" with the four possibilities
